<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiCustomerApp.Views.MainPage"
             Title="Lista de Clientes"
             BackgroundColor="#F8F9FA">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header com título e contador -->
        <Border Grid.Row="0"
                BackgroundColor="White"
                Stroke="#E9ECEF"
                StrokeThickness="1"
                Margin="0,0,0,10">
            <Grid Padding="20,20"
                  ColumnDefinitions="*,Auto">
                <VerticalStackLayout Grid.Column="0"
                                     Spacing="5">
                    <Label Text="Gerenciamento de Clientes"
                           FontSize="26"
                           FontAttributes="Bold"
                           TextColor="#2C3E50"/>
                    <Label Text="{Binding Customers.Count, StringFormat='Total: {0} clientes'}"
                           FontSize="15"
                           TextColor="#6C757D"/>
                </VerticalStackLayout>

                <Border Grid.Column="1"
                        BackgroundColor="#007BFF"
                        Stroke="Transparent"
                        StrokeShape="RoundRectangle 30"
                        WidthRequest="60"
                        HeightRequest="60">
                    <Label Text="👥"
                           FontSize="28"
                           TextColor="White"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>
                </Border>
            </Grid>
        </Border>

        <!-- Lista de clientes com design melhorado -->
        <ScrollView Grid.Row="1"
                    Padding="15,0">
            <CollectionView ItemsSource="{Binding Customers}"
                            SelectionMode="Single"
                            SelectedItem="{Binding SelectedCustomer}"
                            BackgroundColor="Transparent">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Margin="0,8"
                                BackgroundColor="White"
                                Stroke="#DEE2E6"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 16"
                                Padding="0">

                            <!-- Visual States para efeito de seleção -->
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal"/>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="Stroke"
                                                    Value="#007BFF"/>
                                            <Setter Property="StrokeThickness"
                                                    Value="3"/>
                                            <Setter Property="BackgroundColor"
                                                    Value="#F0F8FF"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>

                            <!-- Efeito de sombra -->
                            <Border.Shadow>
                                <Shadow Brush="#40000000"
                                        Offset="0,4"
                                        Radius="12"
                                        Opacity="0.15"/>
                            </Border.Shadow>

                            <Grid Padding="20,16"
                                  ColumnDefinitions="Auto,*,Auto">
                                <!-- Avatar com inicial do nome -->
                                <Border Grid.Column="0"
                                        BackgroundColor="#007BFF"
                                        Stroke="Transparent"
                                        StrokeShape="RoundRectangle 28"
                                        WidthRequest="56"
                                        HeightRequest="56"
                                        VerticalOptions="Center">
                                    <Label Text="{Binding Name, StringFormat='{0:C1}'}"
                                           FontSize="22"
                                           FontAttributes="Bold"
                                           TextColor="White"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>

                                <!-- Informações do cliente -->
                                <VerticalStackLayout Grid.Column="1"
                                                     Margin="16,0,0,0"
                                                     Spacing="6"
                                                     VerticalOptions="Center">
                                    <Label>
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{Binding Name}"
                                                      FontAttributes="Bold"
                                                      FontSize="18"
                                                      TextColor="#212529"/>
                                                <Span Text=" "/>
                                                <Span Text="{Binding Lastname}"
                                                      FontAttributes="Bold"
                                                      FontSize="18"
                                                      TextColor="#212529"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <HorizontalStackLayout Spacing="8">
                                        <Label Text="📍"
                                               FontSize="14"
                                               TextColor="#6C757D"/>
                                        <Label Text="{Binding Address}"
                                               FontSize="14"
                                               TextColor="#6C757D"
                                               LineBreakMode="TailTruncation"/>
                                    </HorizontalStackLayout>

                                    <HorizontalStackLayout Spacing="8">
                                        <Label Text="🎂"
                                               FontSize="14"
                                               TextColor="#6C757D"/>
                                        <Label Text="{Binding Age, StringFormat='{0} anos'}"
                                               FontSize="14"
                                               TextColor="#6C757D"/>
                                    </HorizontalStackLayout>
                                </VerticalStackLayout>

                                <!-- Indicador visual para item selecionado -->
                                <Border Grid.Column="2"
                                        BackgroundColor="#28A745"
                                        Stroke="Transparent"
                                        StrokeShape="RoundRectangle 15"
                                        WidthRequest="30"
                                        HeightRequest="30"
                                        VerticalOptions="Center"
                                        IsVisible="False">
                                    <Label Text="✓"
                                           FontSize="16"
                                           FontAttributes="Bold"
                                           TextColor="White"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"/>
                                </Border>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </ScrollView>

        <!-- Botões de ação com design Material -->
        <Border Grid.Row="2"
                BackgroundColor="White"
                Stroke="#E9ECEF"
                StrokeThickness="1"
                Padding="20,16"
                Margin="0,10,0,0">

            <Grid ColumnDefinitions="*,*,*"
                  ColumnSpacing="12">
                <!-- Botão Add -->
                <Border Grid.Column="0"
                        BackgroundColor="#28A745"
                        Stroke="Transparent"
                        StrokeShape="RoundRectangle 14"
                        HeightRequest="52">
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding AddCommand}"/>
                    </Border.GestureRecognizers>

                    <VerticalStackLayout Spacing="4"
                                         VerticalOptions="Center">
                        <Label Text="➕"
                               FontSize="18"
                               TextColor="White"
                               HorizontalOptions="Center"/>
                        <Label Text="Adicionar"
                               FontSize="13"
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>

                <!-- Botão Edit -->
                <Border Grid.Column="1"
                        BackgroundColor="#FFC107"
                        Stroke="Transparent"
                        StrokeShape="RoundRectangle 14"
                        HeightRequest="52">
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding EditCommand}"/>
                    </Border.GestureRecognizers>

                    <VerticalStackLayout Spacing="4"
                                         VerticalOptions="Center">
                        <Label Text="✏️"
                               FontSize="18"
                               TextColor="White"
                               HorizontalOptions="Center"/>
                        <Label Text="Editar"
                               FontSize="13"
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>

                <!-- Botão Delete -->
                <Border Grid.Column="2"
                        BackgroundColor="#DC3545"
                        Stroke="Transparent"
                        StrokeShape="RoundRectangle 14"
                        HeightRequest="52">
                    <Border.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding DeleteCommand}"/>
                    </Border.GestureRecognizers>

                    <VerticalStackLayout Spacing="4"
                                         VerticalOptions="Center">
                        <Label Text="🗑️"
                               FontSize="18"
                               TextColor="White"
                               HorizontalOptions="Center"/>
                        <Label Text="Excluir"
                               FontSize="13"
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </Border>
            </Grid>
        </Border>
    </Grid>
</ContentPage>
